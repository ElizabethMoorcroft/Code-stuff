print(j)
if(abs(tempdata$block_time.difference[i]-possible.difference[j])<0.5){
tempdata$block_dist.difference[i]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
tempdata$block_bearing[i]<-direction.of.animal(tempdata[c(i-1,i),])
tempdata$block_angle.difference[i]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
}
return(tempdata)
}
convert.locid.into.data(Data,no.of.miss.occasions=1,loc.ids=b[[1]][[325]])
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
convert.locid.into.data<-function(data,no.of.miss.occasions,loc.ids){
tempdata<-data[which(data$LocID %in% loc.ids),]
possible.difference<-(1:no.of.miss.occasions)*5
length.data<-length(loc.ids)
block_dist.difference<-rep(NA,length.data);block_time.difference<-rep(NA,length.data)
block_bearing<-rep(NA,length.data);block_angle.difference<-rep(NA,length.data)
add.blanks<-c()
tempdata<-as.data.frame(cbind(tempdata,block_dist.difference,block_time.difference,block_bearing,block_angle.difference))
newtemp<-tempdata[1,]
for(i in 2:length(loc.ids)){
time<-diff.time.between.locations(tempdata$Date_Time[c(i-1,i)])
if(abs(temp$block_time.difference[i]-possible.difference[1])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=1));names(temp)<-names(tempdata)
temp$block_time.difference[1]<-time
temp$block_dist.difference[1]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[1]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[1]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
for(j in 2:no.of.miss.occasions){
print(j)
if(abs(temp$block_time.difference[i]-possible.difference[j])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=j));names(temp)<-names(tempdata)
temp$block_time.difference[j]<-time
temp$block_dist.difference[j]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[j]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[j]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
newdata<-rbind(newdata,temp)
}
return(tempdata)
}
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
convert.locid.into.data<-function(data,no.of.miss.occasions,loc.ids){
tempdata<-data[which(data$LocID %in% loc.ids),]
possible.difference<-(1:no.of.miss.occasions)*5
length.data<-length(loc.ids)
block_dist.difference<-rep(NA,length.data);block_time.difference<-rep(NA,length.data)
block_bearing<-rep(NA,length.data);block_angle.difference<-rep(NA,length.data)
add.blanks<-c()
tempdata<-as.data.frame(cbind(tempdata,block_dist.difference,block_time.difference,block_bearing,block_angle.difference))
newtemp<-tempdata[1,]
for(i in 2:length(loc.ids)){
time<-diff.time.between.locations(tempdata$Date_Time[c(i-1,i)])
if(abs(time-possible.difference[1])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=1));names(temp)<-names(tempdata)
temp$block_time.difference[1]<-time
temp$block_dist.difference[1]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[1]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[1]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
for(j in 2:no.of.miss.occasions){
print(j)
if(abs(time-possible.difference[j])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=j));names(temp)<-names(tempdata)
temp$block_time.difference[j]<-time
temp$block_dist.difference[j]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[j]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[j]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
newdata<-rbind(newdata,temp)
}
return(tempdata)
}
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
convert.locid.into.data<-function(data,no.of.miss.occasions,loc.ids){
tempdata<-data[which(data$LocID %in% loc.ids),]
possible.difference<-(1:no.of.miss.occasions)*5
length.data<-length(loc.ids)
block_dist.difference<-rep(NA,length.data);block_time.difference<-rep(NA,length.data)
block_bearing<-rep(NA,length.data);block_angle.difference<-rep(NA,length.data)
add.blanks<-c()
tempdata<-as.data.frame(cbind(tempdata,block_dist.difference,block_time.difference,block_bearing,block_angle.difference))
newtemp<-tempdata[1,]
for(i in 2:length(loc.ids)){
print(i)
time<-diff.time.between.locations(tempdata$Date_Time[c(i-1,i)])
if(abs(time-possible.difference[1])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=1));names(temp)<-names(tempdata)
temp$block_time.difference[1]<-time
temp$block_dist.difference[1]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[1]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[1]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
for(j in 2:no.of.miss.occasions){
print(j)
if(abs(time-possible.difference[j])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=j));names(temp)<-names(tempdata)
temp$block_time.difference[j]<-time
temp$block_dist.difference[j]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[j]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[j]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
newdata<-rbind(newdata,temp)
}
return(tempdata)
}
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
convert.locid.into.data<-function(data,no.of.miss.occasions,loc.ids){
tempdata<-data[which(data$LocID %in% loc.ids),]
possible.difference<-(1:no.of.miss.occasions)*5
length.data<-length(loc.ids)
block_dist.difference<-rep(NA,length.data);block_time.difference<-rep(NA,length.data)
block_bearing<-rep(NA,length.data);block_angle.difference<-rep(NA,length.data)
add.blanks<-c()
tempdata<-as.data.frame(cbind(tempdata,block_dist.difference,block_time.difference,block_bearing,block_angle.difference))
newtemp<-tempdata[1,]
for(i in 2:length(loc.ids)){
print(i)
time<-diff.time.between.locations(tempdata$Date_Time[c(i-1,i)])
if(abs(time-possible.difference[1])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=1));names(temp)<-names(tempdata)
temp$block_time.difference[1]<-time
temp$block_dist.difference[1]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[1]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[1]<-change.in.animal.direction(tempdata[c(i-1,i),])
}
for(j in 2:no.of.miss.occasions){
print(j)
if(abs(time-possible.difference[j])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=j));names(temp)<-names(tempdata)
temp$block_time.difference[j]<-time
temp$block_dist.difference[j]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[j]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[j]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
newdata<-rbind(newdata,temp)
}
return(tempdata)
}
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
convert.locid.into.data<-function(data,no.of.miss.occasions,loc.ids){
tempdata<-data[which(data$LocID %in% loc.ids),]
possible.difference<-(1:no.of.miss.occasions)*5
length.data<-length(loc.ids)
block_dist.difference<-rep(NA,length.data);block_time.difference<-rep(NA,length.data)
block_bearing<-rep(NA,length.data);block_angle.difference<-rep(NA,length.data)
add.blanks<-c()
tempdata<-as.data.frame(cbind(tempdata,block_dist.difference,block_time.difference,block_bearing,block_angle.difference))
newdata<-tempdata[1,]
for(i in 2:length(loc.ids)){
print(i)
time<-diff.time.between.locations(tempdata$Date_Time[c(i-1,i)])
if(abs(time-possible.difference[1])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=1));names(temp)<-names(tempdata)
temp$block_time.difference[1]<-time
temp$block_dist.difference[1]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[1]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[1]<-change.in.animal.direction(tempdata[c(i-1,i),])
}
for(j in 2:no.of.miss.occasions){
print(j)
if(abs(time-possible.difference[j])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=j));names(temp)<-names(tempdata)
temp$block_time.difference[j]<-time
temp$block_dist.difference[j]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[j]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[j]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
newdata<-rbind(newdata,temp)
}
return(tempdata)
}
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
convert.locid.into.data<-function(data,no.of.miss.occasions,loc.ids){
tempdata<-data[which(data$LocID %in% loc.ids),]
possible.difference<-(1:no.of.miss.occasions)*5
length.data<-length(loc.ids)
block_dist.difference<-rep(NA,length.data);block_time.difference<-rep(NA,length.data)
block_bearing<-rep(NA,length.data);block_angle.difference<-rep(NA,length.data)
add.blanks<-c()
tempdata<-as.data.frame(cbind(tempdata,block_dist.difference,block_time.difference,block_bearing,block_angle.difference))
newdata<-tempdata[1,]
for(i in 2:length(loc.ids)){
print(paste(i,"/",length(loc.ids)))
time<-diff.time.between.locations(tempdata$Date_Time[c(i-1,i)])
if(abs(time-possible.difference[1])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=1));names(temp)<-names(tempdata)
temp$block_time.difference[1]<-time
temp$block_dist.difference[1]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[1]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[1]<-change.in.animal.direction(tempdata[c(i-1,i),])
}
for(j in 2:no.of.miss.occasions){
print(j)
if(abs(time-possible.difference[j])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=j));names(temp)<-names(tempdata)
temp$block_time.difference[j]<-time
temp$block_dist.difference[j]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[j]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[j]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
newdata<-rbind(newdata,temp)
}
return(tempdata)
}
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
convert.locid.into.data<-function(data,no.of.miss.occasions,loc.ids){
tempdata<-data[which(data$LocID %in% loc.ids),]
possible.difference<-(1:no.of.miss.occasions)*5
length.data<-length(loc.ids)
block_dist.difference<-rep(NA,length.data);block_time.difference<-rep(NA,length.data)
block_bearing<-rep(NA,length.data);block_angle.difference<-rep(NA,length.data)
add.blanks<-c()
tempdata<-as.data.frame(cbind(tempdata,block_dist.difference,block_time.difference,block_bearing,block_angle.difference))
newdata<-tempdata[1,]
for(i in 2:length(loc.ids)){
print(paste(i,"/",length(loc.ids)))
time<-diff.time.between.locations(tempdata$Date_Time[c(i-1,i)])
if(abs(time-possible.difference[1])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=1));names(temp)<-names(tempdata)
temp$block_time.difference[1]<-time
temp$block_dist.difference[1]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[1]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[1]<-change.in.animal.direction(tempdata[c(i-1,i),])
}
for(j in 2:no.of.miss.occasions){
print(j)
if(abs(time-possible.difference[j])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=j));names(temp)<-names(tempdata)
temp$block_time.difference[j]<-time
temp$block_dist.difference[j]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[j]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[j]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
newdata<-rbind(newdata,temp)
}
return(newdata)
}
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
convert.locid.into.data<-function(data,no.of.miss.occasions,loc.ids){
w.data<-dim(data)[2]
tempdata<-data[which(data$LocID %in% loc.ids),]
possible.difference<-(1:no.of.miss.occasions)*5
length.data<-length(loc.ids)
block_dist.difference<-rep(NA,length.data);block_time.difference<-rep(NA,length.data)
block_bearing<-rep(NA,length.data);block_angle.difference<-rep(NA,length.data)
add.blanks<-c()
tempdata<-as.data.frame(cbind(tempdata,block_dist.difference,block_time.difference,block_bearing,block_angle.difference))
newdata<-tempdata[1,]
for(i in 2:length(loc.ids)){
print(paste(i,"/",length(loc.ids)))
time<-diff.time.between.locations(tempdata$Date_Time[c(i-1,i)])
if(abs(time-possible.difference[1])<0.5){
temp[1,1:w.data]<-tempdata[c(i),1:w.data]
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=1));names(temp)<-names(tempdata)
temp$block_time.difference[1]<-time
temp$block_dist.difference[1]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[1]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[1]<-change.in.animal.direction(tempdata[c(i-1,i),])
}
for(j in 2:no.of.miss.occasions){
print(j)
if(abs(time-possible.difference[j])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=j));names(temp)<-names(tempdata)
temp[j,1:w.data]<-tempdata[c(i),1:w.data]
temp$block_time.difference[j]<-time
temp$block_dist.difference[j]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[j]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[j]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
newdata<-rbind(newdata,temp)
}
return(newdata)
}
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
convert.locid.into.data<-function(data,no.of.miss.occasions,loc.ids){
w.data<-dim(data)[2]
tempdata<-data[which(data$LocID %in% loc.ids),]
possible.difference<-(1:no.of.miss.occasions)*5
length.data<-length(loc.ids)
block_dist.difference<-rep(NA,length.data);block_time.difference<-rep(NA,length.data)
block_bearing<-rep(NA,length.data);block_angle.difference<-rep(NA,length.data)
add.blanks<-c()
tempdata<-as.data.frame(cbind(tempdata,block_dist.difference,block_time.difference,block_bearing,block_angle.difference))
newdata<-tempdata[1,]
for(i in 2:length(loc.ids)){
print(paste(i,"/",length(loc.ids)))
time<-diff.time.between.locations(tempdata$Date_Time[c(i-1,i)])
if(abs(time-possible.difference[1])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=1));names(temp)<-names(tempdata)
temp[1,1:w.data]<-tempdata[c(i),1:w.data]
temp$block_time.difference[1]<-time
temp$block_dist.difference[1]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[1]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[1]<-change.in.animal.direction(tempdata[c(i-1,i),])
}
for(j in 2:no.of.miss.occasions){
print(j)
if(abs(time-possible.difference[j])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=j));names(temp)<-names(tempdata)
temp[j,1:w.data]<-tempdata[c(i),1:w.data]
temp$block_time.difference[j]<-time
temp$block_dist.difference[j]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[j]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[j]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
newdata<-rbind(newdata,temp)
}
return(newdata)
}
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
warnings()
convert.locid.into.data<-function(data,no.of.miss.occasions,loc.ids){
w.data<-dim(data)[2]
tempdata<-data[which(data$LocID %in% loc.ids),]
possible.difference<-(1:no.of.miss.occasions)*5
length.data<-length(loc.ids)
block_dist.difference<-rep(NA,length.data);block_time.difference<-rep(NA,length.data)
block_bearing<-rep(NA,length.data);block_angle.difference<-rep(NA,length.data)
add.blanks<-c()
tempdata<-as.data.frame(cbind(tempdata,block_dist.difference,block_time.difference,block_bearing,block_angle.difference))
newdata<-tempdata[1,]
for(i in 2:length(loc.ids)){
print(paste(i,"/",length(loc.ids)))
time<-diff.time.between.locations(tempdata$Date_Time[c(i-1,i)])
if(abs(time-possible.difference[1])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=1));names(temp)<-names(tempdata)
temp[1,1:w.data]<-tempdata[i,1:w.data]
temp$block_time.difference[1]<-time
temp$block_dist.difference[1]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[1]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[1]<-change.in.animal.direction(tempdata[c(i-1,i),])
}
for(j in 2:no.of.miss.occasions){
print(j)
if(abs(time-possible.difference[j])<0.5){
temp<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=j));names(temp)<-names(tempdata)
temp[j,1:w.data]<-tempdata[i,1:w.data]
temp$block_time.difference[j]<-time
temp$block_dist.difference[j]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[j]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[j]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
newdata<-rbind(newdata,temp)
}
return(newdata)
}
warnings()
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
change.in.animal.direction<-function(data){
# - Calculates the change in bearing
# - this produces a value between -2pi and 2pi which needs to be corrected
ChangeAngle<-data$Bearing[2]-data$Bearing[1]
if(ChangeAngle>pi){ChangeAngle<-ChangeAngle-2*pi}
else if(ChangeAngle<(-pi)){ChangeAngle<-2*pi+ChangeAngle}
return(ChangeAngle)
}
convert.locid.into.data<-function(data,no.of.miss.occasions,loc.ids){
w.data<-dim(data)[2]
tempdata<-data[which(data$LocID %in% loc.ids),]
possible.difference<-(1:no.of.miss.occasions)*5
length.data<-length(loc.ids)
block_dist.difference<-rep(NA,length.data);block_time.difference<-rep(NA,length.data)
block_bearing<-rep(NA,length.data);block_angle.difference<-rep(NA,length.data)
add.blanks<-c()
tempdata<-as.data.frame(cbind(tempdata,block_dist.difference,block_time.difference,block_bearing,block_angle.difference))
newdata<-tempdata[1,]
for(i in 2:length(loc.ids)){
print(paste(i,"/",length(loc.ids)))
time<-diff.time.between.locations(tempdata$Date_Time[c(i-1,i)])
if(abs(time-possible.difference[1])<0.5){
temp<-tempdata[i]
temp$block_time.difference[1]<-time
temp$block_dist.difference[1]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[1]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[1]<-change.in.animal.direction(tempdata[c(i-1,i),])
}
for(j in 2:no.of.miss.occasions){
print(j)
if(abs(time-possible.difference[j])<0.5){
temp.blank<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=(j-1)));names(temp)<-names(tempdata)
temp<-rbind(temp.blank,tempdata[i]);
temp$block_time.difference[j]<-time
temp$block_dist.difference[j]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[j]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[j]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
newdata<-rbind(newdata,temp)
}
return(newdata)
}
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
convert.locid.into.data<-function(data,no.of.miss.occasions,loc.ids){
w.data<-dim(data)[2]
tempdata<-data[which(data$LocID %in% loc.ids),]
possible.difference<-(1:no.of.miss.occasions)*5
length.data<-length(loc.ids)
block_dist.difference<-rep(NA,length.data);block_time.difference<-rep(NA,length.data)
block_bearing<-rep(NA,length.data);block_angle.difference<-rep(NA,length.data)
add.blanks<-c()
tempdata<-as.data.frame(cbind(tempdata,block_dist.difference,block_time.difference,block_bearing,block_angle.difference))
newdata<-tempdata[1,]
for(i in 2:length(loc.ids)){
print(paste(i,"/",length(loc.ids)))
time<-diff.time.between.locations(tempdata$Date_Time[c(i-1,i)])
if(abs(time-possible.difference[1])<0.5){
temp<-tempdata[i,]
temp$block_time.difference[1]<-time
temp$block_dist.difference[1]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[1]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[1]<-change.in.animal.direction(tempdata[c(i-1,i),])
}
for(j in 2:no.of.miss.occasions){
print(j)
if(abs(time-possible.difference[j])<0.5){
temp.blank<-as.data.frame(matrix(ncol=dim(tempdata)[2],nrow=(j-1)));names(temp)<-names(tempdata)
temp<-rbind(temp.blank,tempdata[i,]);
temp$block_time.difference[j]<-time
temp$block_dist.difference[j]<-Distance.between.GPS.in.meters(tempdata$Latitude[i-1],tempdata$Latitude[i],tempdata$Longitude[i-1],tempdata$Longitude[i])
temp$block_bearing[j]<-direction.of.animal(tempdata[c(i-1,i),])
temp$block_angle.difference[j]<-change.in.animal.direction(tempdata[c(i-1,i),])
break;
}
}
newdata<-rbind(newdata,temp)
}
return(newdata)
}
convert.locid.into.data(Data,no.of.miss.occasions=13,loc.ids=b[[1]][[325]])
b<-animal.run(Data[which(Data$AnimID=="M1"),],no.of.miss.occasions=2)
b
loc.id.tmp<-b[[1]][which(unlist(lapply(b[[1]],length))>=30)]
loc.id.temp
loc.id.tmp
if( length(loc.id.tmp)>2){
print(unique(Data$AnimID)[i])
dist.tmp<-lapply(loc.id.tmp,function(x){Data[which(Data$LocID %in% x),]$Dist_Difference})
plot(xlim=c(0,10),0,type="n",ylim=c(0,1))
plot.log.density<-function(c){points(type="l",density(log(c),na.rm=T))}
lapply(dist.tmp,plot.log.density)
no.records<-length(loc.id.tmp)
for(i in 1:(no.records-1)){for(j in 2:no.records){
no.tests<-choose(no.records,2)
#print(0.05/no.tests)
if(i!=j){
p.value<-ks.test(dist.tmp[i][[1]],dist.tmp[j][[1]])$p.value
#if(p.value<0.05/no.tests){print(p.value)}
}
}}
}
par(mfrow=c(1,1))
if( length(loc.id.tmp)>2){
print(unique(Data$AnimID)[i])
dist.tmp<-lapply(loc.id.tmp,function(x){Data[which(Data$LocID %in% x),]$Dist_Difference})
plot(xlim=c(0,10),0,type="n",ylim=c(0,1))
plot.log.density<-function(c){points(type="l",density(log(c),na.rm=T))}
lapply(dist.tmp,plot.log.density)
no.records<-length(loc.id.tmp)
for(i in 1:(no.records-1)){for(j in 2:no.records){
no.tests<-choose(no.records,2)
#print(0.05/no.tests)
if(i!=j){
p.value<-ks.test(dist.tmp[i][[1]],dist.tmp[j][[1]])$p.value
#if(p.value<0.05/no.tests){print(p.value)}
}
}}
}
loc.id.tmp<-b[[1]][which(unlist(lapply(b[[1]],length))>=50)]
if( length(loc.id.tmp)>2){
print(unique(Data$AnimID)[i])
dist.tmp<-lapply(loc.id.tmp,function(x){Data[which(Data$LocID %in% x),]$Dist_Difference})
plot(xlim=c(0,10),0,type="n",ylim=c(0,1))
plot.log.density<-function(c){points(type="l",density(log(c),na.rm=T))}
lapply(dist.tmp,plot.log.density)
no.records<-length(loc.id.tmp)
for(i in 1:(no.records-1)){for(j in 2:no.records){
no.tests<-choose(no.records,2)
#print(0.05/no.tests)
if(i!=j){
p.value<-ks.test(dist.tmp[i][[1]],dist.tmp[j][[1]])$p.value
#if(p.value<0.05/no.tests){print(p.value)}
}
}}
}
